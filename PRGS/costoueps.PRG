PROCEDURE COSTOUEPS 
PARAMETERS lcCodigo
	&&lcCodigo="01010201"
	LOCAL lcCueps
	lcCueps=COSTOULTIMO()
	IF lcCueps=0
		lcCueps=COSTOREF()	
	ENDIF 

	RETURN lcCueps
ENDPROC 



PROCEDURE COSTOULTIMO
	SELECT;
		TOP 1 ;
		ORDENCOMPRA.FECHA,;
		MAX(COSTO);
	FROM;
		DETALLEORDEN, ORDENCOMPRA; 
	WHERE;
		ORDENCOMPRA.NORDEN=DETALLEORDEN.NORDEN AND DETALLEORDEN.CODIGO=lcCodigo AND !INLIST(substr(ordencompra.norden,1,2),"OA","DV");
	ORDER BY;
		ORDENCOMPRA.FECHA DESC ;
	GROUP BY;
		1 ;
	INTO ARRAY;
		laUeps
		
		
	IF TYPE("laUeps[2]")#"U"
		RETURN laUeps[2]
	ELSE 
		RETURN 0.0000
	ENDIF 
ENDPROC 


PROCEDURE COSTOREF
	SELECT;
		CODIGO,;
		MAX(PRECIOREF);
	FROM;
		INVENTARIO; 
	WHERE;
		INVENTARIO.CODIGO=lcCodigo;
	GROUP BY;
		1 ;
	INTO ARRAY;
		laPref
	

	IF TYPE("laPref[2]")#"U"
		
		RETURN laPref[2]
	ELSE 
		RETURN 0.0000
	ENDIF 

ENDPROC 